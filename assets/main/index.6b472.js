window.__require=function t(e,o,n){function i(c,s){if(!o[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var a="function"==typeof __require&&__require;if(!s&&a)return a(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return i(e[c][1][t]||t)},u,u.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({BridgeController:[function(t,e,o){"use strict";cc._RF.push(e,"7f151LSnAdPb7dd9AUStQpN","BridgeController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=t("./Bridge"),a=cc._decorator,u=a.ccclass,p=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bridgePrefab=null,e._lengthBridge=0,e._isPress=!1,e._currentBridge=null,e._currentBridgeScript=null,e._graPhics=null,e._offset=Math.sqrt(3)/2,e.GROW=5,e}return i(e,t),e.prototype.onLoad=function(){c.eventTarget.on(c.RESET_GAME,this.resetBridge,this),c.eventTarget.on(c.TOUCH_START,this.createBridge,this),c.eventTarget.on(c.TOUCH_END,this.onBridge,this),c.eventTarget.on(c.DROP_BRIDGE,this.dropBridge,this),this._graPhics=this.node.getComponent(cc.Graphics),this._graPhics.lineWidth=5,this._graPhics.strokeColor=cc.Color.WHITE,this.initPool()},e.prototype.initPool=function(){for(var t=0;t<4;t++){var e=cc.instantiate(this.bridgePrefab);e.position=cc.v3(0,-1e3),e.parent=this.node,e.setContentSize(e.getContentSize().width,0)}},e.prototype.resetBridge=function(){this._isPress=!1,this._currentBridge=null,this.node.children.forEach(function(t){t.height=0,t.position=cc.v3(0,-1e3)})},e.prototype.createBridge=function(){this._isPress=!0,this._lengthBridge=0;var t=this.node.children;this._currentBridge=t[t.length-1],this._currentBridgeScript=this._currentBridge.getComponent(l.default),this._currentBridgeScript.init(),c.eventTarget.emit(c.BRIDGE_SOUND)},e.prototype.update=function(){this._isPress&&this._currentBridge&&(1.9*(s.Global.nextBuilding.node.position.y-s.Global.currentBuilding.node.position.y)<this._lengthBridge||(this._lengthBridge+=this.GROW,this._currentBridgeScript.growBridge(this._lengthBridge)))},e.prototype.drawCircle=function(t,e){this._graPhics.clear(),this._graPhics.circle(t.x,t.y,e),this._graPhics.stroke()},e.prototype.onBridge=function(){if(this._isPress=!1,this._lengthBridge<40)return s.Global.isGamePlaying=!0,void(this._currentBridge.position=cc.v3(0,-1e3));this._currentBridgeScript.onBridge(this._lengthBridge)},e.prototype.dropBridge=function(){this._isPress=!1,this._currentBridgeScript.dropBridge(this._lengthBridge)},r([p(cc.Prefab)],e.prototype,"bridgePrefab",void 0),r([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Events":"Events","../Global":"Global","./Bridge":"Bridge"}],Bridge:[function(t,e,o){"use strict";cc._RF.push(e,"97a1bpKiGlLKZ0RKtVF9nE/","Bridge");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.spriteRotation=null,e.START_ANGLE=-30,e.START_SKEW=-30,e.END_SKEW=30,e.DROP_SKEW=80,e._collider=null,e._allNameColliders=["OkColliderDown","GoodColliderDown","PrefectCollider","GoodColliderUp","OkColliderUp","OutSide"],e._bonusArr=[1,1,1,-1,-1,-2],e._allColliders=[],e._bonus=0,e._offset=Math.sqrt(3)/2,e._avt=null,e}return i(e,t),e.prototype.onLoad=function(){this._collider=this.getComponent(cc.BoxCollider)},e.prototype.init=function(){this._avt=this.getComponent(cc.Sprite),this._avt.spriteFrame=s.Global.dirX>0?this.sprite:this.spriteRotation,this._collider.enabled=!0,this._allColliders=[],this._bonus=0,this.node.setSiblingIndex(0);var t=s.Global.dirX,e=s.Global.currentBuilding,o=s.Global.bridgePoints,n=e.buildingType;this.node.height=0,this.node.angle=t*this.START_ANGLE,this.node.skewX=t*this.START_SKEW,this.node.opacity=255;var i=e.node.position,r=o[n].clone().multiply(cc.v3(t,1)),c=i.clone().add(r);this.node.position=c},e.prototype.growBridge=function(t){this.node.height=t,this._collider.size.height=t,this._collider.offset.y=t/2},e.prototype.onBridge=function(t){var e=this,o=s.Global.dirX;cc.tween(this.node).to(.15,{height:1.2*t,skewX:o*this.START_SKEW*.5}).to(.1,{height:1.1*t,skewX:o*this.END_SKEW*.5}).to(.05,{height:t,skewX:o*this.END_SKEW}).call(function(){0==e._bonus&&(e.node.height-=3),e._bonus<0&&(e.node.height+=10),e._bonus>0&&(e._collider.enabled=!1),c.eventTarget.emit(c.CHECK_GAME_OVER,e._bonus,e),c.eventTarget.emit(c.BRIDGE_HIT_SOUND)}).start()},e.prototype.dropBridge=function(t){var e=this;cc.tween(this.node).delay(.5).to(.3,{height:.15*t,skewX:s.Global.dirX*this.DROP_SKEW}).call(function(){e.node.opacity=0}).start()},e.prototype.onShake=function(){cc.tween(this.node).by(.1,{angle:-1}).by(.1,{angle:1}).call(function(){return c.eventTarget.emit(c.NEXT_LEVEL)}).start()},e.prototype.onCollisionEnter=function(t){var e=this;this._allNameColliders.find(function(o,n){t.node.name.includes(o)&&!e._allColliders.includes(o)&&(e._allColliders.push(o),e._bonus+=e._bonusArr[n])})},r([u(cc.SpriteFrame)],e.prototype,"sprite",void 0),r([u(cc.SpriteFrame)],e.prototype,"spriteRotation",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Brother:[function(t,e,o){"use strict";cc._RF.push(e,"4c5bc5FVuhBwLyFOGIvxvMg","Brother");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hatNode=null,e.movePos=[],e._animation=null,e}return i(e,t),e.prototype.init=function(t,e){var o=this;this.hatNode.active=!1,this.node.parent=t,this.node.position=e,this.node.scaleX=.6*s.Global.dirX,this.node.opacity=0,this.scheduleOnce(function(){o.node.opacity=255},.2),c.eventTarget.on(c.BROTHER_START_TWEEN,this.startTween,this),this._animation=this.node.getComponent(cc.Animation),this.setIdleAnim()},e.prototype.startTween=function(t){var e=this,o=this.node.getSiblingIndex(),n=cc.tween(this.node).delay(.05*(o+1));this.movePos.forEach(function(o){n=n.sequence(cc.tween().call(function(){e.node.scaleX=e.node.position.x>o.x?-.6:.6}),cc.tween().to(t,{position:o},{easing:"linear"}))}),n.call(function(){return e.setIdleAnim()}).start(),this.setMoveAnim()},e.prototype.setMoveAnim=function(){this._animation.play("player-move")},e.prototype.setIdleAnim=function(){this._animation.play("player-idle")},r([u(cc.Node)],e.prototype,"hatNode",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Building:[function(t,e,o){"use strict";cc._RF.push(e,"95c18R1NvxLoZYdINvNUFnk","Building");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Enums"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.points=[],e.buildingType=c.BuildingType.medium,e._collider=[],e._dirs=[cc.v3(1,1),cc.v3(-1,1),cc.v3(1,-1),cc.v3(-1,-1)],e}return i(e,t),e.prototype.init=function(t,e,o,n,i,r){var l=this;void 0===r&&(r=c.BuildingType.medium),this.node.parent=t,this.node.position=e,this.node.scale=o,this.buildingType=r;var a=s.Global.bridgePoints[r],u=this.node.getComponentsInChildren(cc.Sprite),p=u[0],h=u.slice(1),_=h.slice(4,6)[0],d=s.Global.dirX>0,g=_.node.angle,f=_.node.skewX;_.node.active=Boolean(i),_.node.angle=d?-Math.abs(g):Math.abs(g),_.node.skewX=d?Math.abs(f):-Math.abs(f),_.node.position=cc.v3(),_.spriteFrame=i,p.node.setAnchorPoint(s.Global.anchors[r]),p.spriteFrame=n,h.slice(0,4).forEach(function(t,e){t.node.position=a.clone().multiply(l._dirs[e]),l.points.push(t.node)});var v=(cc.Vec3.distance(h[0].node.position,h[3].node.position)-65)/2;this._collider=_.getComponentsInChildren(cc.BoxCollider);var y=this._collider,S=y[0],E=y[1],T=(y[2],y[3],y[4],y[5]);E.offset.y=32.5+v/2,T.offset.y=-32.5-v/2,S.offset.y=32.5+2*v,E.size.height=v,T.size.height=v,S.size.height=2*v;var b=cc.v3(e.x,e.y+10),O=cc.v3(e.x,e.y-10);cc.tween(this.node).to(.2,{position:b}).to(.2,{position:O}).to(.2,{position:e}).start()},e.prototype.onShake=function(){var t=this.node.position.clone(),e=cc.v3(t.x,t.y-10);cc.tween(this.node).to(.1,{position:e}).to(.1,{position:t}).start()},r([a],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Enums":"Enums","../Global":"Global"}],Enums:[function(t,e,o){"use strict";cc._RF.push(e,"c50b9zv7O9JoKK52uY5dJ9p","Enums"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuildingType=void 0,function(t){t[t.medium=0]="medium",t[t.small=1]="small",t[t.large=2]="large"}(o.BuildingType||(o.BuildingType={})),cc._RF.pop()},{}],Events:[function(t,e,o){"use strict";cc._RF.push(e,"6cdd6WUrBtHbafbvNBsiIqp","Events"),Object.defineProperty(o,"__esModule",{value:!0}),o.BRIDGE_HIT_SOUND=o.PERFECT_SOUND=o.OK_SOUND=o.GOOD_SOUND=o.MOVE_SOUND=o.FAIL_SOUND=o.HIT_COIN_SOUND=o.BRIDGE_SOUND=o.BUILDING_SOUND=o.BG_SOUND=o.SHOW_BONUS=o.SHOW_MULTIPLY_SCORE=o.SHOW_GAME_OVER=o.SHOW_HOME=o.INIT_BROTHER_ANIM=o.PLAY_HIT_ANIM=o.HIDEN_RUBY=o.START_TWEEN_RUBY_ANIM=o.BROTHER_START_TWEEN=o.BROTHER_MOVE=o.DROP_PLAYER_OUT_SIDE=o.DROP_PLAYER=o.DROP_BRIDGE=o.MOVE_TO_TARGET=o.INIT_PLAYER=o.SET_HIGH_SCORE=o.SET_LEVEL=o.SET_SCORE=o.NEXT_LEVEL=o.TOUCH_END=o.TOUCH_START=o.CHECK_GAME_OVER=o.GAME_OVER=o.RESUME_GAME=o.RESET_GAME=o.START_GAME=o.eventTarget=void 0,o.eventTarget=new cc.EventTarget,o.START_GAME="START_GAME",o.RESET_GAME="RESET_GAME",o.RESUME_GAME="RESUME_GAME",o.GAME_OVER="GAME_OVER",o.CHECK_GAME_OVER="CHECK_GAME_OVER",o.TOUCH_START="TOUCH_START",o.TOUCH_END="TOUCH_END",o.NEXT_LEVEL="NEXT_LEVEL",o.SET_SCORE="SET_SCORE",o.SET_LEVEL="SET_LEVEL",o.SET_HIGH_SCORE="SET_HIGH_SCORE",o.INIT_PLAYER="INIT_PLAYER",o.MOVE_TO_TARGET="MOVE_TO_TARGET",o.DROP_BRIDGE="DROP_BRIDGE",o.DROP_PLAYER="DROP_PLAYER",o.DROP_PLAYER_OUT_SIDE="DROP_PLAYER_OUT_SIDE",o.BROTHER_MOVE="BROTHER_MOVE",o.BROTHER_START_TWEEN="BROTHER_START_TWEEN",o.START_TWEEN_RUBY_ANIM="START_TWEEN_RUBY_ANIM",o.HIDEN_RUBY="HIDEN_RUBY",o.PLAY_HIT_ANIM="PLAY_HIT_ANIM",o.INIT_BROTHER_ANIM="INIT_BROTHER_ANIM",o.SHOW_HOME="SHOW_HOME",o.SHOW_GAME_OVER="SHOW_GAME_OVER",o.SHOW_MULTIPLY_SCORE="SHOW_MULTIPLY_SCORE",o.SHOW_BONUS="SHOW_BONUS",o.BG_SOUND="BG_SOUND",o.BUILDING_SOUND="BUILDING_SOUND",o.BRIDGE_SOUND="BRIDGE_SOUND",o.HIT_COIN_SOUND="HIT_COIN_SOUND",o.FAIL_SOUND="FAIL_SOUND",o.MOVE_SOUND="MOVE_SOUND",o.GOOD_SOUND="GOOD_SOUND",o.OK_SOUND="OK_SOUND",o.PERFECT_SOUND="PERFECT_SOUND",o.BRIDGE_HIT_SOUND="BRIDGE_HIT_SOUND",cc._RF.pop()},{}],GameController:[function(t,e,o){"use strict";cc._RF.push(e,"058a6TnBFVILpDMjdfEruXh","GameController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Enums"),s=t("../Events"),l=t("../Global"),a=t("../LocalStorage"),u=t("./Building"),p=t("./PlayerController"),h=cc._decorator,_=h.ccclass,d=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buildingBlock=null,e.buildingPrefab=null,e.spriteFramesUpFace=[],e.spriteFramesBuilding=[],e._stepY=0,e._stepX=0,e._posY=-200,e._posX=300,e._perfectCount=0,e._playerNode=null,e._buildingCount=1,e._dataSave=new a.DataSave,e}return i(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,s.eventTarget.on(s.NEXT_LEVEL,this.startLevel,this),s.eventTarget.on(s.RESET_GAME,this.resetGame,this),s.eventTarget.on(s.CHECK_GAME_OVER,this.checkGameOver,this),s.eventTarget.on(s.RESUME_GAME,this.resumeGame,this),this.initBuildingPool(),this._playerNode=this.getComponentInChildren(p.default).node},e.prototype.start=function(){this.getDataFromLocalStorage()},e.prototype.getDataFromLocalStorage=function(){var t=a.LocalStorage.getGameData();l.Global.level=(null==t?void 0:t.level)||1,s.eventTarget.emit(s.SET_LEVEL),l.Global.highScore=(null==t?void 0:t.highScore)||0,s.eventTarget.emit(s.SET_HIGH_SCORE),l.Global.score=(null==t?void 0:t.score)||0,this.scheduleOnce(function(){s.eventTarget.emit(s.SET_SCORE,0,l.Global.score)},1),t&&(this._dataSave=t)},e.prototype.checkGameOver=function(t,e){var o=l.Global.nextBuilding.node.position,n=l.Global.currentBuilding.node.position;if(0==t){var i=o.clone().add(n).multiplyScalar(.5);return s.eventTarget.emit(s.DROP_PLAYER,i),void s.eventTarget.emit(s.DROP_BRIDGE)}if(s.eventTarget.emit(s.PLAY_HIT_ANIM,l.Global.nextBuilding.node.position),t<0)s.eventTarget.emit(s.DROP_PLAYER_OUT_SIDE,o);else{var r=l.Global.level*Math.pow(2,t-1);3==t?(this._perfectCount++,r*=this._perfectCount):this._perfectCount=0;var c=l.Global.score+r,u=l.Global.getFibonacci(l.Global.level+1);l.Global.score>=u&&(l.Global.level++,a.LocalStorage.setLevel(l.Global.level)),c>=l.Global.highScore&&(l.Global.highScore=c,s.eventTarget.emit(s.SET_HIGH_SCORE),a.LocalStorage.setHighScore(l.Global.highScore)),e.onShake(),l.Global.nextBuilding.onShake(),s.eventTarget.emit(s.SET_SCORE,l.Global.score,r),s.eventTarget.emit(s.MOVE_TO_TARGET,o),s.eventTarget.emit(s.SHOW_MULTIPLY_SCORE,l.Global.level),s.eventTarget.emit(s.SHOW_BONUS,t,this._perfectCount);var p=[s.OK_SOUND,s.GOOD_SOUND,s.PERFECT_SOUND];s.eventTarget.emit(p[t-1]),l.Global.score=c}},e.prototype.initBuildingPool=function(){for(var t=0;t<6;t++){var e=cc.instantiate(this.buildingPrefab);e.parent=this.buildingBlock,e.getComponentInChildren(cc.Sprite).spriteFrame=null,e.children[e.children.length-1].active=!1}},e.prototype.resumeGame=function(){if(this._dataSave){this._stepY=this._dataSave.stepY,this._stepX=this._dataSave.stepX,this._posY=this._dataSave.posY,this._posX=this._dataSave.posX,this._buildingCount=this._dataSave.buildingCount,this._perfectCount=this._dataSave.perfectCount,this._nextBuildingType=this._dataSave.nextBuildingType;var t=this._dataSave.gamePosition;this.node.position=t,this.node.scale=this._dataSave.scale,l.Global.posStart=this._dataSave.currentBuildingPos,l.Global.isGamePlaying=!0,this.initBuildingResumeGame(),this.node.position=cc.v3(t.x,t.y-100),s.eventTarget.emit(s.INIT_PLAYER)}},e.prototype.initBuildingResumeGame=function(){var t=this.buildingBlock.children[0],e=t.getComponent(u.default),o=this.spriteFramesBuilding[this._dataSave.currentBuildingStyle],n=this.spriteFramesUpFace[this._dataSave.currentBuildingStyle%5];e.init(this.buildingBlock,this._dataSave.currentBuildingPos,1,o,n,this._dataSave.currentBuildingType),l.Global.currentBuilding=e,t.scaleX=-l.Global.dirX;var i=this.buildingBlock.children[1],r=i.getComponent(u.default),c=this.spriteFramesBuilding[this._dataSave.nextBuildingStyle],s=this.spriteFramesUpFace[this._dataSave.nextBuildingStyle%5];r.init(this.buildingBlock,this._dataSave.nextBuildingPos,1,c,s,this._dataSave.nextBuildingType),l.Global.nextBuilding=r,i.scaleX=l.Global.dirX},e.prototype.resetGame=function(){this._stepY=0,this._stepX=0,this._posY=-200,this._posX=300,this._buildingCount=1,this.buildingBlock.children.forEach(function(t){t.position=cc.v3(0,-1e3)}),this.node.position=cc.v3(),this.node.scale=1,l.Global.score=0,this.initBuildingStart()},e.prototype.initBuildingStart=function(){var t=this,e=this.buildingBlock.children[0];e.children[e.children.length-1].active=!0;var o=this.spriteFramesBuilding[0],n=e.getComponent(u.default);l.Global.currentBuilding=n,n.init(this.buildingBlock,cc.v3(0,200),.5,o,null,c.BuildingType.medium);var i=cc.v3(this._posX*l.Global.dirX/2,this._posY);l.Global.posStart=i,s.eventTarget.emit(s.INIT_PLAYER),cc.tween(e).to(1,{position:i,scale:1}).call(function(){return t.startLevel()}).delay(.5).call(function(){return l.Global.isGamePlaying=!0}).start()},e.prototype.startLevel=function(){this._buildingCount++,l.Global.dirX*=-1,this._posY+=this._stepY;var t=l.Global.getRandomInt(0,this.spriteFramesBuilding.length);l.Global.nextBuilding&&(l.Global.currentBuilding=l.Global.nextBuilding);var e=this.buildingBlock.children[this.buildingBlock.children.length-1];e.children[e.children.length-1].active=!0;var o=e.getComponent(u.default);e.setSiblingIndex(0),l.Global.nextBuilding=o;var n=this.spriteFramesBuilding[t],i=this.scaleGame(),r=this.spriteFramesUpFace[t%5];this._nextBuildingType>-1&&(this._dataSave.currentBuildingType=this._nextBuildingType),this._dataSave.nextBuildingStyle>-1&&(this._dataSave.currentBuildingStyle=this._dataSave.nextBuildingStyle),this._nextBuildingType=Math.floor(t/5),this._dataSave.nextBuildingType=this._nextBuildingType,this._dataSave.nextBuildingStyle=t,o.init(this.buildingBlock,i,1,n,r,this._nextBuildingType),a.LocalStorage.setGameData(this._dataSave),s.eventTarget.emit(s.BUILDING_SOUND)},e.prototype.scaleGame=function(){var t=l.Global.currentBuilding.node.position,e=(180+l.Global.angle*l.Global.dirX)%180,o=this._buildingCount<3,n=this._posX*Math.min(1+.005*this._buildingCount,1.3),i=this._posX*Math.min(1.4+.01*this._buildingCount,2.6),r=o?l.Global.getRandomInt(.7*this._posX,.9*this._posX):l.Global.getRandomInt(n,i),c=this.findNextPoint(t,r,e);this._stepX=this.node.position.x+(c.x+t.x)/2;var s=540/(1.4*cc.Vec3.distance(cc.v3(c.x),cc.v3(t.x)));return o?(this._stepX=0,this._stepY=0):(this._stepY=c.y-t.y,cc.tween(this.node).to(1,{scale:s}).start()),this.moveGameNode(o,s),this.SaveGame(t,c,s),c},e.prototype.SaveGame=function(t,e,o){this._dataSave.currentBuildingPos=t,this._dataSave.nextBuildingPos=e,this._dataSave.level=l.Global.level,this._dataSave.score=l.Global.score,this._dataSave.highScore=l.Global.highScore,this._dataSave.buildingCount=this._buildingCount,this._dataSave.perfectCount=this._perfectCount,this._dataSave.scale=o,this._dataSave.stepX=this._stepX,this._dataSave.stepY=this._stepY,this._dataSave.posX=this._posX,this._dataSave.posY=this._posY,this._dataSave.gamePosition=this.node.position,this._dataSave.dirX=l.Global.dirX},e.prototype.moveGameNode=function(t,e){var o=t?-200:-400,n=cc.v3(this.node.position.x-this._stepX,-this._playerNode.position.y+o).multiplyScalar(e);cc.tween(this.node).to(1,{position:n}).delay(.3).call(function(){return s.eventTarget.emit(s.START_TWEEN_RUBY_ANIM,l.Global.nextBuilding.node.position)}).start()},e.prototype.findNextPoint=function(t,e,o){var n=o*(Math.PI/180),i=t.x+e*Math.cos(n),r=t.y+e*Math.sin(n);return new cc.Vec3(i,r)},r([d(cc.Node)],e.prototype,"buildingBlock",void 0),r([d(cc.Prefab)],e.prototype,"buildingPrefab",void 0),r([d([cc.SpriteFrame])],e.prototype,"spriteFramesUpFace",void 0),r([d([cc.SpriteFrame])],e.prototype,"spriteFramesBuilding",void 0),r([_],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../Enums":"Enums","../Events":"Events","../Global":"Global","../LocalStorage":"LocalStorage","./Building":"Building","./PlayerController":"PlayerController"}],GameOverScreen:[function(t,e,o){"use strict";cc._RF.push(e,"460beyEjLlL743RVCrN5b8q","GameOverScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scoreText=null,e._highScoreText=null,e._popup=null,e._homeBtn=null,e._resetBtn=null,e}return i(e,t),e.prototype.onLoad=function(){var t,e,o=this;t=this.node.getComponentsInChildren(cc.Label),this._highScoreText=t[0],this._scoreText=t[1],e=this.node.getComponentsInChildren(cc.Button),this._homeBtn=e[0],this._resetBtn=e[1],this._popup=this.node.children[1],c.eventTarget.on(c.GAME_OVER,this.onShowGameOver,this),this._homeBtn.node.on("click",function(){c.eventTarget.emit(c.SHOW_HOME),o.node.active=!1}),this._resetBtn.node.on("click",function(){c.eventTarget.emit(c.RESET_GAME),o.node.active=!1}),this.node.active=!1,this.node.position=cc.v3()},e.prototype.onShowGameOver=function(){c.eventTarget.emit(c.FAIL_SOUND),this.node.active=!0,this._scoreText.string="SCORE: "+s.Global.score,this._highScoreText.string="BEST: "+s.Global.highScore,this._popup.scale=0,cc.tween(this._popup).to(.5,{scale:1}).start(),cc.tween(this._homeBtn.node).by(0,{angle:-90}).by(.5,{angle:90}).start(),cc.tween(this._resetBtn.node).by(0,{angle:-90}).by(.5,{angle:90}).start()},r([a],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],GamePlayScreen:[function(t,e,o){"use strict";cc._RF.push(e,"98c8cqOvoxMC6A3XVy0wIrA","GamePlayScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bonusContentNode=null,e.bonusNode=null,e.scoreNode=null,e.scoreBlock=null,e.levelBlock=null,e._titleText=null,e._bonusText=null,e._bonusTexts=["OK","GOOD","PERFECT"],e._scoreText=null,e._highScoreText=null,e._currentLevelText=null,e._nextLevelText=null,e._levelProgress=null,e._bg=null,e.colors=[new cc.Color(90,122,224),new cc.Color(90,122,224),new cc.Color(255,0,51)],e}return i(e,t),e.prototype.onLoad=function(){var t,e,o;t=this.bonusNode.getComponentsInChildren(cc.Label),this._titleText=t[0],this._bonusText=t[1],e=this.scoreNode.getComponentsInChildren(cc.Label),this._highScoreText=e[0],this._scoreText=e[1],o=this.levelBlock.getComponentsInChildren(cc.Label),this._currentLevelText=o[0],this._nextLevelText=o[1],this._levelProgress=this.levelBlock.getComponentInChildren(cc.ProgressBar),this._bg=this.bonusNode.getComponentInChildren(cc.Sprite).node,this.bonusNode.active=!1,c.eventTarget.on(c.SET_SCORE,this.setScore,this),c.eventTarget.on(c.SET_LEVEL,this.setLevel,this),c.eventTarget.on(c.SET_HIGH_SCORE,this.setHighScore,this),c.eventTarget.on(c.GAME_OVER,this.onGameOver,this),c.eventTarget.on(c.RESET_GAME,this.showTopBar,this),c.eventTarget.on(c.RESUME_GAME,this.showTopBar,this),c.eventTarget.on(c.SHOW_BONUS,this.showBonus,this),this.scoreBlock.opacity=0,this.scoreBlock.scale=0,this.node.position=cc.v3(),this._levelProgress.progress=0},e.prototype.showBonus=function(t,e){this.bonusNode.active=!0,this.bonusNode.opacity=255,this.bonusNode.scale=0,this.bonusContentNode.scale=0,this._bg.color=this.colors[t-1],this._titleText.string=e<2?this._bonusTexts[t-1]:"PERFECT x"+e;var o=s.Global.level*Math.pow(2,t-1);e>0&&(o*=e),this._bonusText.string="+"+o,cc.tween(this.bonusNode).to(.3,{scale:1}).delay(.5).to(.5,{opacity:0}).start(),cc.tween(this.bonusContentNode).to(.2,{scale:2}).to(.1,{scale:1}).start()},e.prototype.onGameOver=function(){cc.tween(this.scoreBlock).to(.5,{opacity:0,scale:0}).start()},e.prototype.showTopBar=function(){this._scoreText.string="0",this._highScoreText.string="BEST: "+s.Global.highScore,cc.tween(this.scoreBlock).to(.5,{opacity:255,scale:1}).start()},e.prototype.setScore=function(t,e){this.effRunNumber(this._scoreText,t,t+e,.5);var o=s.Global.level;this._currentLevelText.string=""+o,this._nextLevelText.string=""+(o+1);var n=s.Global.getFibonacci(s.Global.level+1),i=s.Global.getFibonacci(s.Global.level);10==i&&(i=0),this._levelProgress.progress=(s.Global.highScore-i)/(n-i)},e.prototype.effRunNumber=function(t,e,o,n){if(cc.Tween.stopAllByTarget(t.node),e!==o){t.string=e;var i=o-e,r=i/30;cc.tween(t.node).sequence(cc.tween().call(function(){e+=r,i>0?e>=o&&(e=o,t.node.stopActionByTag(0)):e<=o&&(e=o,cc.Tween.stopAllByTarget(t.node)),t.string=Math.floor(e)}),cc.tween().delay(n/30)).repeat(31).start()}},e.prototype.setHighScore=function(){this._highScoreText.string="BEST: "+s.Global.highScore},e.prototype.setLevel=function(){var t=s.Global.level;this._currentLevelText.string=""+t,this._nextLevelText.string=""+(t+1)},r([u(cc.Node)],e.prototype,"bonusContentNode",void 0),r([u(cc.Node)],e.prototype,"bonusNode",void 0),r([u(cc.Node)],e.prototype,"scoreNode",void 0),r([u(cc.Node)],e.prototype,"scoreBlock",void 0),r([u(cc.Node)],e.prototype,"levelBlock",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],Global:[function(t,e,o){"use strict";cc._RF.push(e,"99f76r4q9VI75VyO3dmcZf9","Global"),Object.defineProperty(o,"__esModule",{value:!0}),o.Global=void 0;var n=function(){function t(){}return t.getFibonacci=function(t){t+=1;for(var e=[0,1],o=2;o<t;o++)e[o]=e[o-1]+e[o-2];return 10*(e=e.slice(t-2,t)).reduce(function(t,e){return t+e},0)},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.angle=30,t.dirX=1,t.currentBuilding=null,t.nextBuilding=null,t.posStart=null,t.bridgePoints=[cc.v3(37,23),cc.v3(34,17),cc.v3(48,28)],t.anchors=[cc.v2(.505,.89),cc.v2(.54,.88),cc.v2(.483,.878)],t.upFacePos=[{v:cc.v3(1.1,1.5),h:cc.v3(.5,1.8)},{v:cc.v3(-1.6,-.2),h:cc.v3(-.3,-.3)},{v:cc.v3(-.3,1.1),h:cc.v3(1.6,1)}],t.score=0,t.highScore=0,t.level=1,t.isGamePlaying=!1,t.isGameOver=!1,t}();o.Global=n,cc._RF.pop()},{}],HitAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"f6a73/PVdJKArErl4K3vgi6","HitAnimation");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=cc._decorator,l=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animation=null,e}return i(e,t),e.prototype.onLoad=function(){this._animation=this.node.getComponent(cc.Animation),c.eventTarget.on(c.PLAY_HIT_ANIM,this.playHitAnimation,this)},e.prototype.playHitAnimation=function(t){this.node.setPosition(t),this._animation.play("hit-anim")},r([l],e)}(cc.Component));o.default=a,cc._RF.pop()},{"../Events":"Events"}],HomeScreen:[function(t,e,o){"use strict";cc._RF.push(e,"58c00wFfC1BH5luYCapQ5mh","HomeScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=cc._decorator,l=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bg=null,e._x=0,e._y=0,e._z=0,e._count=0,e._isShake=!1,e}return i(e,t),e.prototype.onLoad=function(){var t;this.getComponentInChildren(cc.Button).node.on("click",this.onButtonPlayClick,this),c.eventTarget.on(c.SHOW_HOME,this.showHomeScreen,this),this.node.position=cc.v3(),this._bg=this.node.getComponentInChildren(cc.Sprite),t=this.node,cc.resources.loadDir("3D_Rotate",cc.SpriteFrame,function(e,o){if(e)console.error("L\u1ed7i load \u1ea3nh:",e);else{var n=cc.AnimationClip.createWithSpriteFrames(o,o.length);n.name="bottleSpin",n.wrapMode=cc.WrapMode.Loop,n.speed=1;var i=t.getComponent(cc.Animation)||t.addComponent(cc.Animation);i.addClip(n),i.play("bottleSpin")}})},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.testDevice()},3)},e.prototype.testDevice=function(){var t=this;window.addEventListener("devicemotion",function(e){var o=t.getComponentInChildren(cc.RichText),n=e.accelerationIncludingGravity.x,i=e.accelerationIncludingGravity.y,r=e.accelerationIncludingGravity.z;o.string="\n            "+n.toFixed(2)+" \n            "+i.toFixed(2)+" \n            "+r.toFixed(2),(n-t._x>8||i-t._y>8||r-t._z>8)&&t._isShake&&t._count++,(n-t._x<-8||i-t._y<-8||r-t._z<-8)&&(t._isShake||t._count++),t._count>0&&t.scheduleOnce(function(){t._count=0},1.5),t._count>5&&(t._count=0,cc.tween(t.node).to(1,{position:cc.v3(10,0,0)},{easing:"elasticOut"}).to(1,{position:cc.v3(-10,0,0)},{easing:"elasticOut"}).to(1,{position:cc.v3(10,0,0)},{easing:"elasticOut"}).to(1,{position:cc.v3(-10,0,0)},{easing:"elasticOut"}).to(1,{position:cc.v3(0,0,0)}).start()),t._x=n,t._y=i,t._z=r})},e.prototype.onResumeGame=function(){c.eventTarget.emit(c.RESUME_GAME),this.node.active=!1},e.prototype.onButtonPlayClick=function(){this.node.active=!1,c.eventTarget.emit(c.RESET_GAME)},e.prototype.showHomeScreen=function(){this.node.active=!0},r([l],e)}(cc.Component));o.default=a,cc._RF.pop()},{"../Events":"Events"}],InitBrotherAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"6830f5BElVOiIkInadUQPLC","InitBrotherAnimation");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=cc._decorator,l=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animation=null,e}return i(e,t),e.prototype.onLoad=function(){this._animation=this.node.getComponent(cc.Animation),c.eventTarget.on(c.INIT_BROTHER_ANIM,this.playAnimation,this)},e.prototype.playAnimation=function(t){this.node.setPosition(t),this._animation.play()},r([l],e)}(cc.Component));o.default=a,cc._RF.pop()},{"../Events":"Events"}],LocalStorage:[function(t,e,o){"use strict";cc._RF.push(e,"9c520AjziNCuLU+TvD+mp7i","LocalStorage"),Object.defineProperty(o,"__esModule",{value:!0}),o.LocalStorage=o.DataSave=void 0;o.DataSave=function(){this.currentBuildingStyle=0,this.nextBuildingStyle=0};var n=function(){function t(){}return t.getGameData=function(){return JSON.parse(localStorage.getItem(this.GAME_DATA))},t.setGameData=function(t){localStorage.setItem(this.GAME_DATA,JSON.stringify(t))},t.getNextBuildingType=function(){return Number(localStorage.getItem(this.NEXT_BUILDING_TYPE))},t.setNextBuildingType=function(t){localStorage.setItem(this.NEXT_BUILDING_TYPE,t.toString())},t.getCurrentBuildingType=function(){return Number(localStorage.getItem(this.CURRENT_BUILDING_TYPE))},t.setCurrentBuildingType=function(t){localStorage.setItem(this.CURRENT_BUILDING_TYPE,t.toString())},t.getStyleNextBuilding=function(){return Number(localStorage.getItem(this.STYLE_NEXT_BUILDING))},t.setStyleNextBuilding=function(t){localStorage.setItem(this.STYLE_NEXT_BUILDING,t.toString())},t.getStyleCurrentBuilding=function(){return Number(localStorage.getItem(this.STYLE_CURRENT_BUILDING))},t.setStyleCurrentBuilding=function(t){localStorage.setItem(this.STYLE_CURRENT_BUILDING,t.toString())},t.getPerfectCount=function(){return Number(localStorage.getItem(this.PERFECT_COUNT))},t.setPerfectCount=function(t){localStorage.setItem(this.PERFECT_COUNT,t.toString())},t.getStepX=function(){return Number(localStorage.getItem(this.STEP_X))},t.setStepX=function(t){localStorage.setItem(this.STEP_X,t.toString())},t.getStepY=function(){return Number(localStorage.getItem(this.STEP_Y))},t.setStepY=function(t){localStorage.setItem(this.STEP_Y,t.toString())},t.getPosX=function(){return Number(localStorage.getItem(this.POS_X))},t.setPosX=function(t){localStorage.setItem(this.POS_X,t.toString())},t.getPosY=function(){return Number(localStorage.getItem(this.POS_Y))},t.setPosY=function(t){localStorage.setItem(this.POS_Y,t.toString())},t.getGamePosition=function(){return JSON.parse(localStorage.getItem(this.GAME_POSITION))},t.setGamePosition=function(t){localStorage.setItem(this.GAME_POSITION,JSON.stringify(t))},t.getGameScale=function(){return JSON.parse(localStorage.getItem(this.GAME_SCALE))},t.setGameScale=function(t){localStorage.setItem(this.GAME_SCALE,JSON.stringify(t))},t.getBuildingCount=function(){return Number(localStorage.getItem(this.BUILDING_COUNT))},t.setBuildingCount=function(t){localStorage.setItem(this.BUILDING_COUNT,t.toString())},t.getScore=function(){return Number(localStorage.getItem(this.SCORE))},t.setScore=function(t){localStorage.setItem(this.SCORE,t.toString())},t.setLevel=function(t){localStorage.setItem(this.LEVEL,t.toString())},t.getLevel=function(){return Number(localStorage.getItem(this.LEVEL))},t.getHighScore=function(){return Number(localStorage.getItem(this.HIGH_SCORE))},t.setHighScore=function(t){localStorage.setItem(this.HIGH_SCORE,t.toString())},t.setCurrentBuildingPos=function(t){localStorage.setItem(this.CURRENT_BUILDING,JSON.stringify(t))},t.getCurrentBuildingPos=function(){return JSON.parse(localStorage.getItem(this.CURRENT_BUILDING))},t.setNextBuildingPos=function(t){localStorage.setItem(this.NEXT_BUILDING,JSON.stringify(t))},t.getNextBuildingPos=function(){return JSON.parse(localStorage.getItem(this.NEXT_BUILDING))},t.clear=function(){localStorage.clear()},t.LEVEL="SKY_BRIDGE_LEVEL",t.HIGH_SCORE="SKY_BRIDGE_HIGH_SCORE",t.SCORE="SKY_BRIDGE_SCORE",t.GAME_POSITION="SKY_BRIDGE_GAME_POSITION",t.GAME_SCALE="SKY_BRIDGE_GAME_SCALE",t.STEP_X="SKY_BRIDGE_STEP_X",t.STEP_Y="SKY_BRIDGE_STEP_Y",t.POS_X="SKY_BRIDGE_POS_X",t.POS_Y="SKY_BRIDGE_POS_Y",t.PERFECT_COUNT="SKY_BRIDGE_PERFECT_COUNT",t.BUILDING_COUNT="SKY_BRIDGE_BUILDING_COUNT",t.NEXT_BUILDING="SKY_BRIDGE_NEXT_BUILDING",t.CURRENT_BUILDING="SKY_BRIDGE_CURRENT_BUILDING",t.STYLE_NEXT_BUILDING="SKY_BRIDGE_STYLE_NEXT_BUILDING",t.STYLE_CURRENT_BUILDING="SKY_BRIDGE_STYLE_CURRENT_BUILDING",t.NEXT_BUILDING_TYPE="SKY_BRIDGE_NEXT_BUILDING_TYPE",t.CURRENT_BUILDING_TYPE="SKY_BRIDGE_CURRENT_BUILDING_TYPE",t.GAME_DATA="SKY_BRIDGE_GAME_DATA",t}();o.LocalStorage=n,cc._RF.pop()},{}],PlayerController:[function(t,e,o){"use strict";cc._RF.push(e,"95c05RfkR9J5qdnu+qB4p63","PlayerController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,s=r.length;c<s;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../Events"),l=t("../Global"),a=t("./Brother"),u=cc._decorator,p=u.ccclass,h=u.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.brotherPrefab=null,e.parentBrother=null,e.parentPlayerDrop=null,e.multiplyScore=null,e._brothers=[],e._targetOutside=null,e._isMoveToEndBridge=!1,e._multiplyScoreText=null,e._parentPlayerMove=null,e._posMove=[],e._animation=null,e._timeMove=1.5,e.BRIDGE="Bridge",e}return i(e,t),e.prototype.onLoad=function(){s.eventTarget.on(s.INIT_PLAYER,this.reset,this),s.eventTarget.on(s.RESET_GAME,this.reset,this),s.eventTarget.on(s.MOVE_TO_TARGET,this.moveToTarget,this),s.eventTarget.on(s.DROP_PLAYER,this.dropPlayer,this),s.eventTarget.on(s.DROP_PLAYER_OUT_SIDE,this.dropPlayerOutside,this),this._parentPlayerMove=this.node.parent,this._multiplyScoreText=this.multiplyScore.getComponentInChildren(cc.Label),this.multiplyScore.active=!1,s.eventTarget.on(s.SHOW_MULTIPLY_SCORE,this.showMultiplyScore,this),this.node.scale=1,this._animation=this.getComponent(cc.Animation),this._siblingIndex=this.node.getSiblingIndex()},e.prototype.update=function(t){this._isMoveToEndBridge&&(this.node.position=this.node.position.add(this._targetOutside.mul(400*t/this._timeMove)),cc.Vec3.distance(this.node.position,l.Global.nextBuilding.node.position)<10&&s.eventTarget.emit(s.HIDEN_RUBY))},e.prototype.showMultiplyScore=function(t){this.multiplyScore.active=!0,this._multiplyScoreText.string="x"+t,this.multiplyScore.position=cc.v3(0,100),this.multiplyScore.opacity=255,this.multiplyScore.scaleX=l.Global.dirX,cc.tween(this.multiplyScore).to(.5,{position:cc.v3(0,200)}).to(.5,{opacity:0,position:cc.v3(0,200)}).start()},e.prototype.dropPlayer=function(t,e){var o=this;void 0===e&&(e=this._timeMove/2),this.setMoveAnim(),cc.tween(this.node).to(e,{position:t}).call(function(){o.setDropAnim()}).delay(.4).call(function(){o.node.parent=o.parentPlayerDrop,o.node.setSiblingIndex(Math.round(e))}).by(1,{position:cc.v3(0,-500,0),opacity:-255}).call(function(){s.eventTarget.emit(s.GAME_OVER),o.node.parent=o._parentPlayerMove}).start()},e.prototype.dropPlayerOutside=function(t){this._targetOutside=t.clone().sub(this.node.position).normalize(),this._isMoveToEndBridge=!0,this.setMoveAnim()},e.prototype.reset=function(){var t=this;this._isMoveToEndBridge=!1,this._targetOutside=null,this.node.position=l.Global.posStart,this._brothers.forEach(function(e){e.opacity=0,e.position=t.node.position}),this.node.setSiblingIndex(this._siblingIndex+1),this.node.opacity=0,this.setIdleAnim(),cc.tween(this.node).delay(1).to(.2,{opacity:255}).by(.2,{position:cc.v3(0,20)}).call(function(){t.node.scaleX=l.Global.dirX,t._brothers.forEach(function(t){t.opacity=255})}).by(.2,{position:cc.v3(0,-20)}).start()},e.prototype.moveToTarget=function(t){var e=this;this._posMove=[],l.Global.level>this.parentBrother.children.length+1&&this.parentBrother.children.length<40&&this.initBrother(),this.node.setSiblingIndex(this._siblingIndex);for(var o=t.clone().sub(this.node.position),n=o.mag(),i=40/n,r=o.normalize().mul(n*i),u=0;u<Math.round(1/i)+1;u++)this._posMove.push(this.node.position.clone().add(r.mul(u)));var p=c(this._posMove);for(u=0;u<this._brothers.length;u++){var h=this._brothers[u],_=h.getComponent(a.default);p.pop(),_.movePos=c(p),p.unshift(h.position)}s.eventTarget.emit(s.BROTHER_START_TWEEN,i*this._timeMove),this.setMoveAnim(),cc.tween(this.node).to(this._timeMove,{position:t}).call(function(){return s.eventTarget.emit(s.HIDEN_RUBY)}).by(.2,{position:cc.v3(0,20)}).call(function(){e.node.scaleX=l.Global.dirX,l.Global.isGamePlaying=!0,e.setIdleAnim()}).by(.2,{position:cc.v3(0,-20)}).start(),s.eventTarget.emit(s.MOVE_SOUND)},e.prototype.initBrother=function(){var t,e=cc.instantiate(this.brotherPrefab),o=(null===(t=this._brothers[this._brothers.length-1])||void 0===t?void 0:t.position)||this.node.position;e.getComponent(a.default).init(this.parentBrother,o),s.eventTarget.emit(s.INIT_BROTHER_ANIM,o),this._brothers.push(e)},e.prototype.onCollisionExit=function(t){t.node.name==this.BRIDGE&&this._isMoveToEndBridge&&(this.dropPlayer(this.node.position,0),this._isMoveToEndBridge=!1)},e.prototype.setMoveAnim=function(){this._animation.play("player-move")},e.prototype.setIdleAnim=function(){this._animation.play("player-idle")},e.prototype.setDropAnim=function(){this._animation.play("player-drop")},r([h(cc.Prefab)],e.prototype,"brotherPrefab",void 0),r([h(cc.Node)],e.prototype,"parentBrother",void 0),r([h(cc.Node)],e.prototype,"parentPlayerDrop",void 0),r([h(cc.Node)],e.prototype,"multiplyScore",void 0),r([p],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../Events":"Events","../Global":"Global","./Brother":"Brother"}],RubyAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"75ee26ibdVIs4NkVk0JT9dZ","RubyAnimation");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scaleNode=null,e.haloNode=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;c.eventTarget.on(c.START_TWEEN_RUBY_ANIM,this.startTweenRuby,this),c.eventTarget.on(c.RESET_GAME,this.hideRuby,this),c.eventTarget.on(c.HIDEN_RUBY,this.hideRuby,this),this.hideRuby(),this.scaleNode.children.forEach(function(e){var o=s.Global.getRandomInt(1,2),n=s.Global.getRandomInt(.5,1);t.scaleAnim(e,o,n)});var e=this.haloNode.children,o=e[0],n=e[1],i=e[2];this.scaleHalo(o,3.2),this.scaleHalo(n,1.7),this.scaleHalo(i,1.5)},e.prototype.hideRuby=function(){cc.Tween.stopAllByTarget(this.node),this.node.position=cc.v3(0,-1e3)},e.prototype.startTweenRuby=function(t){0!=s.Global.getRandomInt(0,2)?(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).repeatForever(cc.tween(this.node).to(0,{position:t}).by(1,{position:cc.v3(0,50)}).by(1,{position:cc.v3(0,-50)})).start(),cc.tween(this.node).to(.1,{scale:.1}).to(.25,{scale:.5}).to(.1,{scale:.4}).to(.25,{scale:.5}).start()):this.node.position=cc.v3(0,-1e3)},e.prototype.scaleAnim=function(t,e,o){void 0===e&&(e=1),void 0===o&&(o=1),cc.tween(t).repeatForever(cc.tween(t).to(o,{scale:1*e}).to(o,{scale:.5*e})).start()},e.prototype.scaleHalo=function(t,e){void 0===e&&(e=1),cc.tween(t).repeatForever(cc.tween(t).to(0,{opacity:255}).to(0,{scale:.74}).to(e,{scale:1}).to(.7*e,{opacity:0})).start()},r([u(cc.Node)],e.prototype,"scaleNode",void 0),r([u(cc.Node)],e.prototype,"haloNode",void 0),r([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}],SoundManager:[function(t,e,o){"use strict";cc._RF.push(e,"b1018ueVdlLLYwNLM/Sns3I","SoundManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Events"),s=cc._decorator,l=s.ccclass,a=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSound=null,e.buildingSound=null,e.bridgeSound=null,e.hitCoinSound=null,e.failSound=null,e.moveSound=null,e.goodSound=null,e.okSound=null,e.perfectSound=null,e.bridgeHitSound=null,e}return i(e,t),e.prototype.onLoad=function(){c.eventTarget.on("BG_SOUND",this.playBgSound,this),c.eventTarget.on("BUILDING_SOUND",this.playBuildingSound,this),c.eventTarget.on("BRIDGE_SOUND",this.playBridgeSound,this),c.eventTarget.on("HIT_COIN_SOUND",this.playHitCoinSound,this),c.eventTarget.on("FAIL_SOUND",this.playFailSound,this),c.eventTarget.on("MOVE_SOUND",this.playMoveSound,this),c.eventTarget.on("GOOD_SOUND",this.playGoodSound,this),c.eventTarget.on("OK_SOUND",this.playOkSound,this),c.eventTarget.on("PERFECT_SOUND",this.playPerfectSound,this),c.eventTarget.on("BRIDGE_HIT_SOUND",this.playBridgeHitSound,this)},e.prototype.playBgSound=function(){this.bgSound.play()},e.prototype.playBuildingSound=function(){this.buildingSound.play()},e.prototype.playBridgeSound=function(){this.bridgeSound.play()},e.prototype.playHitCoinSound=function(){this.hitCoinSound.play()},e.prototype.playFailSound=function(){this.failSound.play()},e.prototype.playMoveSound=function(){this.moveSound.play()},e.prototype.playGoodSound=function(){this.goodSound.play()},e.prototype.playOkSound=function(){this.okSound.play()},e.prototype.playPerfectSound=function(){this.perfectSound.play()},e.prototype.playBridgeHitSound=function(){this.bridgeHitSound.play()},r([a(cc.AudioSource)],e.prototype,"bgSound",void 0),r([a(cc.AudioSource)],e.prototype,"buildingSound",void 0),r([a(cc.AudioSource)],e.prototype,"bridgeSound",void 0),r([a(cc.AudioSource)],e.prototype,"hitCoinSound",void 0),r([a(cc.AudioSource)],e.prototype,"failSound",void 0),r([a(cc.AudioSource)],e.prototype,"moveSound",void 0),r([a(cc.AudioSource)],e.prototype,"goodSound",void 0),r([a(cc.AudioSource)],e.prototype,"okSound",void 0),r([a(cc.AudioSource)],e.prototype,"perfectSound",void 0),r([a(cc.AudioSource)],e.prototype,"bridgeHitSound",void 0),r([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Events":"Events"}],TouchController:[function(t,e,o){"use strict";cc._RF.push(e,"1de58hbbttC8odbVf3C4vRq","TouchController");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Events"),s=t("../Global"),l=cc._decorator,a=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isTouchStart=!1,e}return i(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},e.prototype.onTouchStart=function(){s.Global.isGamePlaying&&!this._isTouchStart&&(this._isTouchStart=!0,c.eventTarget.emit(c.TOUCH_START))},e.prototype.onTouchEnd=function(){s.Global.isGamePlaying&&this._isTouchStart&&(s.Global.isGamePlaying=!1,this._isTouchStart=!1,c.eventTarget.emit(c.TOUCH_END))},r([a],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Events":"Events","../Global":"Global"}]},{},["Enums","Events","Bridge","BridgeController","Brother","Building","GameController","HitAnimation","InitBrotherAnimation","PlayerController","RubyAnimation","TouchController","Global","LocalStorage","SoundManager","GameOverScreen","GamePlayScreen","HomeScreen"]);